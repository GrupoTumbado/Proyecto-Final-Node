<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<title>RH Taller Node</title>
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
	<link rel="stylesheet" href="./css/employees.css">
	<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
	<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
	<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
	<script src="./js/employees.js"></script>
</head>

<body>
<div class="row">
	<div class="col"></div>
	<div class="col-10">
		<div class="card card-body">
			<!-- Form Wrapper & Button -->
			<button class="btn btn-sm btn-primary" id="btn-new-employee">Añadir Empleado</button>
			<div class="form-wrapper hidden mt-2 mb-2">
				<div class="form-row">
					<div class="form-group col-md-6">
						<label for="input-name">Nombre</label>
						<input type="text" class="form-control" id="input-name" placeholder="Nombre">
						<small class="form-text text-muted">El nombre del empleado.</small>
					</div>
					<div class="form-group col-md-6">
						<label for="input-surname">Apellidos</label>
						<input type="text" class="form-control" id="input-surname" placeholder="Apellidos">
						<small class="form-text text-muted">Los apellidos del empleado.</small>
					</div>
				</div>
				<div class="form-group">
					<label for="input-phone">Teléfono</label>
					<input type="tel" class="form-control" id="input-phone" placeholder="Teléfono">
					<small class="form-text text-muted">El usuario o correo con el que te registraste.</small>
				</div>
				<div class="form-group">
					<label for="input-mail">Mail</label>
					<input type="email" class="form-control" id="input-mail" placeholder="Mail">
					<small class="form-text text-muted">El usuario o correo con el que te registraste.</small>
				</div>
				<div class="form-group">
					<label for="input-address">Dirección</label>
					<input type="text" class="form-control" id="input-address" placeholder="Dirección">
					<small class="form-text text-muted">La dirección del empleado.</small>
				</div>
				<button class="btn btn-sm btn-info" id="btn-add-employee" >Añadir</button>
			</div>

			<!-- Data Table -->
			<table class="table table-dark">
				<thead>
				<tr>
					<th scope="col">Nombre</th>
					<th scope="col">Apellidos</th>
					<th scope="col">Teléfono</th>
					<th scope="col">Mail</th>
					<th scope="col">Dirección</th>
				</tr>
				</thead>
				<tbody id="employees-table">
				</tbody>
			</table>
		</div>
	</div>
	<div class="col"></div>
</div>

<script>
	/*var newId = 4
	var newTest = {'name': null, 'id': newId, 'result': null}


	$('#test-result').on('keyup', function () {
		newTest.result = $(this).val()
		console.log(newTest)

	})

	$('#test-name').on('change', function () {
		newTest.name = $(this).val()
		console.log(newTest)
	})

	$('#create-test').on('click', function () {
		if (newTest.name == null) {
			alert('No test selected!')
		} else {
			addRow(newTest)
			$('#test-name').val('')
			$('#test-result').val('')
			$('.form-wrapper').addClass('hidden')
		}
	})

	var tests = [
		{'name': 'Distillation 50%', 'id': '1', 'result': "43"},
		{'name': 'Flash Point', 'id': '2', 'result': "61"},
		{'name': 'Water By Karl Fischer', 'id': '3', 'result': "24"},
	]


	for (var i in tests) {
		addRow(tests[i])
	}

	function addRow(obj) {
		var row = `<tr scope="row" class="test-row-${obj.id}">
	    			   <td>${obj.name}</td>
	    			   <td>${obj.name}</td>
	    			   <td>${obj.name}</td>
	    			   <td>${obj.name}</td>
	                   <td id="result-${obj.id}" data-testid="${obj.id}"">${obj.result}</td>
	                   <td>
	                   		<button class="btn btn-sm btn-danger" data-testid=${obj.id} id="delete-${obj.id}">Delete</button>
	                   		<button class="btn btn-sm btn-info" disabled data-testid="${obj.id}"  id="save-${obj.id}">Save</button>

	                   		<button class="btn btn-sm btn-danger hidden" data-testid="${obj.id}"  id="cancel-${obj.id}">Cancel</button>
	                   		<button class="btn btn-sm btn-primary hidden" data-testid="${obj.id}"  id="confirm-${obj.id}">Confirm</button>

	                   </td>
	    		   </tr>`
		$('#tests-table').append(row)

		$(`#delete-${obj.id}`).on('click', deleteTest)
		$(`#cancel-${obj.id}`).on('click', cancelDeletion)
		$(`#confirm-${obj.id}`).on('click', confirmDeletion)
		$(`#save-${obj.id}`).on('click', saveUpdate)


		$(`#result-${obj.id}`).on('click', editName)
	}

	function editName() {
		var testid = $(this).data('testid')
		var value = $(this).html()

		$(this).unbind()
		$(this).html(`<input class="result form-control" data-testid="${testid}" type="text" value="${value}">`)

		$(`.result`).on('keyup', function () {
			var testid = $(this).data('testid')
			var saveBtn = $(`#save-${testid}`)
			saveBtn.prop('disabled', false)

		})
	}

	function saveUpdate() {
		console.log('Saved!')
		var testid = $(this).data('testid')
		var saveBtn = $(`#save-${testid}`)
		var row = $(`.test-row-${testid}`)

		saveBtn.prop('disabled', true)
		row.css('opacity', "0.5")

		setTimeout(function () {
			row.css('opacity', '1')
		}, 2000)
	}


	function deleteEmployee() {
		var testid = $(this).data('testid')

		var deleteBtn = $(`#delete-${testid}`)
		var saveBtn = $(`#save-${testid}`)
		var cancelBtn = $(`#cancel-${testid}`)
		var confirmBtn = $(`#confirm-${testid}`)

		deleteBtn.addClass('hidden')
		saveBtn.addClass('hidden')

		cancelBtn.removeClass('hidden')
		confirmBtn.removeClass('hidden')
	}

	function cancelDeletion() {
		var testid = $(this).data('testid')

		var deleteBtn = $(`#delete-${testid}`)
		var saveBtn = $(`#save-${testid}`)
		var cancelBtn = $(`#cancel-${testid}`)
		var confirmBtn = $(`#confirm-${testid}`)

		deleteBtn.removeClass('hidden')
		saveBtn.removeClass('hidden')

		cancelBtn.addClass('hidden')
		confirmBtn.addClass('hidden')

	}

	function confirmDeletion() {
		var testid = $(this).data('testid')
		var row = $(`.test-row-${testid}`)
		row.remove()
	}*/
</script>
</body>
</html>